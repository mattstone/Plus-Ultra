<div data-controller="communications">
  <%= form_with(model: [:admin, communication]) do |f| %>
    <%= render 'shared/form_results', resource: communication %>

    <div class="field">
      <%= f.label :name, class: "form-label" %><br />
      <%= f.text_field :name, placeholder: "Communication name", class: "form-control", required: true %>
    </div>

    <br>
    <div class="field">
      <%= f.label :lifecyle, class: "form-label" %><br />
      <%= f.select :lifecycle, Communication.lifecycles.keys.map { |key| [key.titleize, key]}, {}, { class: "form-control", "data-communications-target": "communication_type", "data-action": "communications#change_communication_type" } %>
    </div>

    <br>
    <div class="field">
      <%= f.label :type, class: "form-label" %><br />
      <%= f.select :communication_type, Communication.communication_types.keys.map { |key| [key.titleize, key]}, {}, { class: "form-control", "data-communications-target": "communication_type", "data-action": "communications#change_communication_type" } %>
    </div>

    <br>
    <div class="field">
      <%= f.label :campaign, class: "form-label" %><br />
      <select name="communication[campaign_id]" id="communication_campaign_id" class="form-control">
        <% Campaign.order(:channel_id).each do |campaign| %>
          <% selected = campaign.id == communication.campaign_id ? "selected" : "" %>
          <option value="<%= campaign.id %>" <%= selected %>>
            <%= "#{campaign.channel.name} - #{campaign.name}" %>
          </option>
        <% end %>
      </select>
    </div>
    
    <% class_string = communication.email? ? "" : "d-none" %>

    <div id="email_fields" class="<%= class_string %>" data-communications-target="email_fields">
      <br>
      <div class="field">
        <%= f.label :email_layout, class: "form-label" %><br />
        <%= f.select :layout, Communication.layouts.keys.map { |key| [key.titleize, key]}, {}, { class: "form-control", "data-communications-target": "layout", "data-action": "communications#change_layout" } %>
      </div>
      
      <br>
      <div class="field">
        <%= f.label :email_subject, class: "form-label" %><br />
        <%= f.text_field :subject, placeholder: "Email Subject", class: "form-control",  required: true %>
      </div>

      <br>
      <div class="field">
          <%= f.label :email_preview %>
          <%= f.rich_text_area :preview, class: "form-control" %>
      </div>
    </div>
    
    <div class="field">
      <hr>
    </div>
    
    <div class="row bg-primary">
      <div class="col text-white"><strong>Instructions</strong></div>
    </div>
    <br>
    <div class="row">
      <div class="col-2"><strong>Email</strong></div>
      <div class="col-8">
        Enter raw html. Conform to Email standards and only use tables and hard code styles.
      </div>
    </div>
    <br>
    <div class="row">
      <div class="col-2"><strong>SMS</strong></div>
      <div class="col-8">
        Messages over 255 characters will be sent as multiple SMS messages and will be charged as such
      </div>
    </div>
    <br>
    <div class="row">
      <div class="col-2"><strong>Inbound & Outbound Telephone</strong></div>
      <div class="col-8">
        Enter the scripts for the operators to follow. Use plenty of white space aid readability.
      </div>
    </div>

    <br>
    <div class="row bg-primary">
      <div class="col-2 text-white"><strong>Helper</strong></div>
      <div class="col-4 text-white"><strong>Description</strong></div>
      <div class="col-2 text-white"><strong>Helper</strong></div>
      <div class="col-4 text-white"><strong>Description</strong></div>
    </div>
    
    <br>
    <div class="row">
      <div class="col-2 text-secondary">%FIRST_NAME%</div>
      <div class="col-4">First name of user</div>
      <div class="col-2 text-secondary">%FULL_NAME%</div>
      <div class="col-4">First and last name of user</div>
    </div>
    <div class="row">
      <div class="col-2 text-secondary">%2FA_CODE%</div>
      <div class="col-4">2 Factor Authentication Code</div>
      <div class="col-2 text-secondary"></div>
      <div class="col-4"></div>
    </div>

    <br>
    <div class="field">
        <%= f.label :content %>
        <%= f.rich_text_area :content, class: "form-control" %>
    </div>

    <div>
      <br>
      <%= f.submit class: admin_button_class, id: "channel_form_button" %>
    </div>
  <% end %>
</div>


